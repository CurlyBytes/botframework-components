stages:
- stage : prepare
  jobs:
  - job: Prepare
    steps:
    - template: ../tasks/displayEnvironmentVariablesSteps.yml
- stage: Build_pack
  displayName: Build and package
  dependsOn: Prepare
  jobs:
    - job: NugetPack
      displayName: Create nuget package
      steps:
      # Use `nuget` instead of `dotnet` due to dependency on .nuspec file
      - template: ../tasks/nugetPackSteps.yml
      - template: ../tasks/publishBuildArtifactsNugetSteps.yml
      - template: ../tasks/debugWorkspaceSteps.yml
    - job: NpmPack
      displayName: Create npm package
      steps:
      - template: ../tasks/copyNpmFilesSteps.yml
      - template: ../tasks/publishBuildArtifactsNpmSteps.yml
      - template: ../tasks/debugWorkspaceSteps.yml